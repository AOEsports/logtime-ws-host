<script>
	function passData(parsedData) {
		
		const data = parsedData.data;
		
		console.log(`got data`, data);
		document.getElementById("load.Map").innerHTML =
			data.matchInformation.map;
		document.getElementById("load.MapMode").innerHTML =
			data.matchInformation.mode;
		document.getElementById(
			"load.MapModeImage"
		).src = `/public/imgs/${data.matchInformation.mode}.webp`;
		document.getElementById("load.Team1").innerHTML =
			data.matchInformation.team_1;
		document.getElementById("load.Team2").innerHTML =
			data.matchInformation.team_2;
		document.getElementById("load.RoundStatus").innerHTML =
			data.round_status;

		const serverLoad = data.server_load;
		document.getElementById("load.Current").innerHTML = serverLoad.current;
		document.getElementById("load.Peak").innerHTML = serverLoad.peak;
		document.getElementById("load.Average").innerHTML = serverLoad.average;

		const parserLoad = parsedData.parser_load;
		document.getElementById("parser.ConnectionCount").innerHTML =
			parserLoad.totalConnections;

		document.getElementById("parser.Lines").innerHTML =
			parserLoad.lineCount;

		document.getElementById(
			"parser.ParseTime"
		).innerHTML = `${parserLoad.parseTime}ms`;

		document.getElementById("parser.CurrentFile").innerHTML =
			parserLoad.fileName.replace("Log-", "").replace(".txt", "");
	}
</script>
<div class="mui-appbar mui-container-fluid" style="margin-bottom: 2rem">
	<div class="mui--text-display2 mui-row">
		<span
			class="mui-col-md-2"
			style="
				padding-right: 4rem;
				padding-left: 2rem;
				padding-top: 0.2rem;
				display: inline-block;
			"
		>
			<image src="/favicon.png" height="48px" /> </span
		><span class="mui-col-md-4">LogTime WS Viewer</span>
		<span
			class="mui--text-right mui-col-md-6 mui--text-body2"
			style="padding-right: 2px"
		>
			<button
				onclick="connectToWebSocket()"
				class="mui-btn mui-btn--accent mui-btn--small"
			>
				Reconnect
			</button>
			Connections
			<span class="dataTarget" id="parser.ConnectionCount">
				Waiting
			</span>
		</span>
	</div>
</div>
<div class="mui-container">
	<div class="mui-panel">
		<ul class="mui-tabs__bar">
			<li class="mui--is-active">
				<a data-mui-toggle="tab" data-mui-controls="ow-match-info"
					>Overwatch Match Information</a
				>
			</li>
			<li>
				<a data-mui-toggle="tab" data-mui-controls="ow-server-load"
					>Overwatch Server Load</a
				>
			</li>
			<li>
				<a data-mui-toggle="tab" data-mui-controls="parser-server-load"
					>Parser Server Load</a
				>
			</li>
		</ul>
		<div class="mui-tabs__pane mui--is-active" id="ow-match-info">
			<div class="mui--text-display2">Overwatch Match Information</div>
			<div class="mui--text-body1 mui-row">
				<div class="mui--text-display1 mui-col-md-4">
					Map
					<div class="mui--text-headline dataTarget" id="load.Map">
						Waiting
					</div>
				</div>

				<div class="mui--text-display1 mui-col-md-4">
					Team 1
					<div class="mui--text-headline dataTarget" id="load.Team1">
						Waiting
					</div>
				</div>
				<div class="mui--text-display1 mui-col-md-4">
					Team 2
					<div class="mui--text-headline dataTarget" id="load.Team2">
						Waiting
					</div>
				</div>
				<div class="mui--text-display1 mui-col-md-4">
					Mode
					<div>
						<image
							src="/public/imgs/Assault.webp"
							width="32px"
							style="display: inline"
							id="load.MapModeImage"
						/>
						<div
							class="mui--text-headline dataTarget"
							id="load.MapMode"
							style="display: inline"
						>
							Waiting
						</div>
					</div>
				</div>

				<div class="mui--text-display1 mui-col-md-4">
					Round Status
					<div
						class="mui--text-headline dataTarget"
						id="load.RoundStatus"
					>
						Waiting
					</div>
				</div>

				<div class="mui--text-display1 mui-col-md-4">
					Match ID
					<div
						class="mui--text-headline dataTarget"
						id="parser.CurrentFile"
					>
						Waiting
					</div>
				</div>
			</div>
		</div>
		<div class="mui-tabs__pane" id="ow-server-load">
			<div class="mui--text-display2">Overwatch Server Load</div>
			<div class="mui--text-body1 mui-row">
				<div class="mui--text-display1 mui-col-md-4">
					Current
					<div
						class="mui--text-headline dataTarget"
						id="load.Current"
					>
						Waiting
					</div>
				</div>

				<div class="mui--text-display1 mui-col-md-4">
					Peak
					<div class="mui--text-headline dataTarget" id="load.Peak">
						Waiting
					</div>
				</div>
				<div class="mui--text-display1 mui-col-md-4">
					Average
					<div
						class="mui--text-headline dataTarget"
						id="load.Average"
					>
						Waiting
					</div>
				</div>
			</div>
		</div>
		<div class="mui-tabs__pane" id="parser-server-load">
			<div class="mui--text-display2">Parser Server Load</div>
			<div class="mui--text-body1 mui-row">
				<div class="mui--text-display1 mui-col-md-4">
					Connections
					<div
						class="mui--text-headline dataTarget"
						id="parser.ConnectionCount"
					>
						Waiting
					</div>
				</div>
				<div class="mui--text-display1 mui-col-md-4">
					Lines
					<div
						class="mui--text-headline dataTarget"
						id="parser.Lines"
					>
						Waiting
					</div>
				</div>
				<div class="mui--text-display1 mui-col-md-4">
					Last Time to Parse
					<div
						class="mui--text-headline dataTarget"
						id="parser.ParseTime"
					>
						Waiting
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
